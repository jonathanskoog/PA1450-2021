<html>
<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <!-- <link rel="scrollable" href="scroll.css"> -->
  <title>Covid-Center</title>
  <meta name="description" content="PA1450"/>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<style>
  .scrollable-menu {
    height: auto;
    max-height: 180px;
    overflow-x: hidden;
  }
</style>
<body>
  <div class="jumbotron text-center bg-dark text-white">
    <h1>Covid Center</h1>
    <p>Track covid data from all around the world!</p>
  </div>

  <div class="row">
    <div class="col-sm-2"></div>
    <div class="col-sm-10">
      <h2>Post your raw GitHub url</h2>
    </div>
  </div>

    <div class="row">
      <div class="col-sm-1"></div>
      <div class="col-sm-1">
        <button type="submit" id="button1" name="action" onclick="load_csv()" class="btn btn-primary btn-block bg-lg">Load</button>
      </div>
      <div class="form-group col-sm-8">
        <input type="text" class="form-control" id="File-Url" name="File-Url" placeholder="Raw Url">
      </div>
      <div class="col-sm-2"></div>
    </div>

    <div class="row">
      <div class="col-sm-12">
        <div class="jumbotron text-center bg-primary text-white" id="csv_load_status">
          <h3>Press load</h3>
        </div>
      </div>
    </div>


    <div class="row">
      <div class="col-sm-2 jumbotron bg-dark text-white">
          <div class="row">
            <h2>Options</h2>
          </div>
          <div class="row">
            <div class="dropdown">
              <button class="btn btn-secondary dropdown-toggle" type="button" id="Filter-Country" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Filter by country
              </button>
              <div class="dropdown-menu scrollable-menu" id="FC-DROP" aria-labelledby="Filter-Country" type="menu">
                <a class="dropdown-item btn" id="drop1-btn1"onclick="set_dropdown_text(Filter-Country,drop1-btn1)" ref="#">Sverige</a>
              </div>
            </div>
          </div>
      </div>

    </div>


  <!-- <p>The API can be used over at <a href="/add/1/3">/add/&lt;a&gt;/&lt;b&gt;</a>.</p>
  <object data="/data" style="width: 100%">
    <embed src="/add/1/3"></embed>
  </object>

  <img src="/plot/1"/> -->


  <input type="button" id='script' name="scriptbutton" value=" Run Script " onclick="goPython()">

  <script src="http://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

  <script>
      function goPython(){
          $.ajax({
            url: "MYSCRIPT.py",
           context: document.body
          }).done(function() {
           alert('finished python script');;
          });
      }
  </script>

<!-- 
  <script type="python"> 
    def runPythonTableCode(url):
      import pandas as pd
      a = pd.read_csv(url)
      a.to_html("table_html_code.html")
        

  </script> -->
<script>

function load_csv()
{
  var jqXHR = $.post("/saveCSV", {
    csv_file: document.getElementById("File-Url").value
  })
  .done(function(response) {
    load_status(response);
    get_countries();
  })
  
}

function get_countries()
{
  var jqXHR = $.get("/countries")
  .done(function(response){
    console.log(response)
  })
}

function set_dropdown_text(drop_id="", text_id="")
{
  document.getElementById(drop_id).innerHTML = "Sverige"
}

function load_status(status="")
{
  var jumbo = document.getElementById("csv_load_status")
  if (status == "success")
  {
    jumbo.classList.remove("bg-dark")
    jumbo.classList.add("bg-success")
    jumbo.innerHTML = "<h3>Success!</h3>"
  } 
  else
  {
    jumbo.classList.remove("bg-dark")
    jumbo.classList.add("bg-danger")
    jumbo.innerHTML = "<h3>Error, Try again!</h3>"
  }
}
</script>

  <!-- <h1>MVP Covid-Center</h1>
  <label for="furl">Raw GitHub file Url:</label>
  <form action="/show_graph" method="post" enctype="multipart/form-data">
    <input type="text" id="furl" name="furl"> <br><br>
    <input type="submit" name="action" value="Display Graph">
    <input type="submit" name="action" value="Display Table">
  </form>
  <object data="/data" style="width: 100%">
    <embed src="/greeting/Joe%20Doe"></embed>
  </object>


  <p>The API can be used over at <a href="/add/1/3">/add/&lt;a&gt;/&lt;b&gt;</a>.</p>
  <object data="/data" style="width: 100%">
    <embed src="/add/1/3"></embed>
  </object>


  <img src="/plot/5"/>
  
</body>
</html>
